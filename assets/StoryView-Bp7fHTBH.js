var D=Object.defineProperty;var F=(r,e,t)=>e in r?D(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var n=(r,e,t)=>F(r,typeof e!="symbol"?e+"":e,t);import{d as I,r as $,o as M,a as O,c as f,b as o,e as l,n as N,f as p,u as g,t as h,F as A,g as E,h as G,i,_ as L}from"./index-CUCV4tPS.js";class U{constructor(e={}){n(this,"id");n(this,"img");this.id=e.id||"",this.img=e.img||""}}class j{constructor(e={}){n(this,"id","");n(this,"img","");this.id=e.id||"",this.img=e.img||""}}var v=(r=>(r.text="text",r.line="line",r.options="options",r))(v||{});class k{constructor(e={}){n(this,"id");n(this,"type");n(this,"text");n(this,"character");n(this,"scene");n(this,"prev");n(this,"next");this.id=e.id||"",this.type=e.type||"text",this.text=e.text||"",this.character=e.character,this.scene=e.scene,this.prev=e.prev,this.next=e.next}}class q extends k{constructor(t={}){super(t);n(this,"header","");this.header=t.header}}class z{constructor(e={}){n(this,"text");n(this,"next");this.text=e.text||"",this.next=e.next||""}}class H extends k{constructor(t={}){super(t);n(this,"options");this.options=(t.options||[]).map(s=>new z(s))}}class J{constructor(e={}){n(this,"characters",[]);n(this,"scenes",[]);n(this,"story",[]);this.characters=(e.characters||[]).map(t=>new U(t)),this.scenes=(e.scenes||[]).map(t=>new j(t)),this.story=(e.story||[]).map(t=>{const s=this.scenes.find(u=>u.id===t.scene),x=this.characters.find(u=>u.id===t.character);if(t.type==="text")return new q({...t,scene:s,character:x});if(t.type==="options"){const u=(t.options||[]).map(d=>new z(d));return new H({...t,scene:s,character:x,options:u})}return new k({...t,scene:s,character:x})})}}const K=[{id:"Настя",img:"/story/characters/nastya.png"},{id:"Юра",img:"/story/characters/yura.png"}],P=[{id:"Концерт",img:"/story/scenes/concert.png"},{id:"Закулисье",img:"/story/scenes/backstage.png"},{id:"Улица",img:"/story/scenes/street.png"}],Q=[{id:"1",type:"text",header:"Часть 1: Вечер на выступлении",text:"Настя вошла в концертный зал, где уже звучала музыка.",character:"Настя",scene:"Концерт",next:"2"},{id:"2",type:"text",text:"Настя заметила Юру возле сцены. Он выглядел напряжённым.",character:"Настя",scene:"Концерт",next:"3"},{id:"3",type:"options",text:"Что делать?",character:"Настя",scene:"Концерт",options:[{text:"Подойти к Юре",next:"4"},{text:"Остаться на месте",next:"5"}]},{id:"4",type:"line",text:"- Привет!, — сказал он с улыбкой.",character:"Юра",scene:"Концерт",next:"6"},{id:"5",type:"text",header:"Решение остаться",text:"Настя решила остаться на месте и просто наблюдать за происходящим.",character:"Настя",scene:"Концерт",next:"6"},{id:"6",type:"text",header:"Неожиданность",text:"Внезапно свет в зале погас, и раздался звук разбившегося стекла.",scene:"Концерт",next:"7"},{id:"7",type:"options",text:"Как реагировать на это?",character:"Настя",scene:"Концерт",options:[{text:"Попробовать найти выход",next:"8"},{text:"Остаться и осмотреться",next:"9"}]},{id:"8",type:"text",header:"Путь к выходу",text:"Настя решила найти выход. Она пошла к двери, но наткнулась на охранника.",character:"Настя",scene:"Концерт",next:"10"},{id:"9",type:"text",header:"Осторожный осмотр",text:"Настя осталась в зале и начала всматриваться в темноту. Она заметила силуэт у сцены.",character:"Настя",scene:"Концерт",next:"10"},{id:"10",type:"options",text:"Что делать дальше?",character:"Настя",scene:"Концерт",options:[{text:"Подойти к силуэту",next:"11"},{text:"Попробовать спрятаться",next:"12"}]},{id:"11",type:"text",header:"Подход к силуэту",text:"Настя подошла ближе. Это был Юра. 'Ты здесь?', — шепнул он.",character:"Юра",scene:"Закулисье",next:"13"},{id:"12",type:"text",header:"Попытка спрятаться",text:"Настя спряталась за колонной и услышала шаги. Кто-то медленно приближался.",scene:"Концерт",next:"13"},{id:"13",type:"text",header:"Загадка",text:"Свет внезапно включился, и все замерли. Это был только первый шаг к раскрытию тайны.",scene:"Улица"}],R={characters:K,scenes:P,story:Q},T={key:0},W=["src"],X={class:"story-content"},Y={key:1},Z={key:2},ee={key:3},te={class:"options"},se=["onClick"],ne=I({__name:"StoryView",setup(r){const e=$(null);M(()=>{e.value=new Audio("/public/story/sounds/theme.mp3"),e.value.loop=!0,e.value.volume=.5,e.value.play().catch(a=>{console.warn("Музыка не может быть воспроизведена автоматически:",a)})}),O(()=>{e.value&&(e.value.pause(),e.value=null)});const t=new J(R),s=$(t.story[0]),x=f(()=>{var a,c;return((c=(a=s.value)==null?void 0:a.scene)==null?void 0:c.img)||"/default-background.png"}),u=f(()=>{var a,c;return((c=(a=s.value)==null?void 0:a.character)==null?void 0:c.img)||"/default-background.png"}),d=f(()=>{var a,c;return((c=(a=s.value)==null?void 0:a.character)==null?void 0:c.id)==="Настя"}),_=a=>{if(!a)return;const c=t.story.find(m=>m.id===a);c?s.value=c:console.error("Block not found:",a),console.log(c)};return console.log(t),(a,c)=>{var m,w,b,B,C,S,V;return i(),o("div",{class:"story-container",style:G({backgroundImage:`url(${x.value})`})},[((m=s.value)==null?void 0:m.character)!==void 0?(i(),o("div",T,[l("img",{class:N(["character",{"character-main":d.value,"character-secondary":!d.value}]),src:u.value},null,10,W)])):p("",!0),l("div",X,[((w=s.value)==null?void 0:w.type)!==g(v).text&&((b=s.value)==null?void 0:b.character)!==void 0?(i(),o("span",{key:0,class:N(["character-name",{"character-main":d.value,"character-secondary":!d.value}])},h((B=s.value)==null?void 0:B.character.id),3)):p("",!0),((C=s.value)==null?void 0:C.type)===g(v).text?(i(),o("div",Y,[l("h1",null,h(s.value.header),1),l("p",null,h(s.value.text),1),s.value.next?(i(),o("button",{key:0,class:"btn btn-primary",onClick:c[0]||(c[0]=y=>_(s.value.next))}," Далее ")):p("",!0)])):p("",!0),((S=s.value)==null?void 0:S.type)===g(v).line?(i(),o("div",Z,[l("h1",null,h(s.value.header),1),l("p",null,h(s.value.text),1),s.value.next?(i(),o("button",{key:0,class:"btn btn-primary",onClick:c[1]||(c[1]=y=>_(s.value.next))}," Далее ")):p("",!0)])):((V=s.value)==null?void 0:V.type)===g(v).options?(i(),o("div",ee,[l("p",null,h(s.value.text),1),l("div",te,[(i(!0),o(A,null,E(s.value.options,y=>(i(),o("button",{key:y.text,class:"btn btn-option",onClick:re=>_(y.next)},h(y.text),9,se))),128))])])):p("",!0)])],4)}}}),oe=L(ne,[["__scopeId","data-v-e79b941c"]]);export{oe as default};
